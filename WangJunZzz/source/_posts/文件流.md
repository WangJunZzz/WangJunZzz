---
title: 文件流
date: 2019-08-06 23:39:56
tags:
- 文件
categories:
- DotNet
---

### 文件
- 文件是存储在具有特定名称和目录路径的磁盘中的数据的集合。当文件打开以进行读取或写入时，它将成为流。
- 流基本上是通过通信路径的字节序列。有两个主要流：输入流和输出流。输入流用于从文件读取数据(读取操作)，输出流用于写入文件(写入操作)。

### FileStream
``` csharp
        // 写入
        FileStream f = new FileStream("e:\\filestream-demo.txt", FileMode.OpenOrCreate);//creating file stream  
        f.WriteByte(65);//writing byte into stream  
        f.Close();//closing stream

        // 读取
        FileStream f = new FileStream("e:\\filestream-demo.txt", FileMode.OpenOrCreate);
        int i = 0;  
        while ((i = f.ReadByte()) != -1)  
        {  
            Console.Write((char)i);  
        }  
        f.Close();
```

### StreamReader
``` csharp
        // 一行一行读取
        FileStream f = new FileStream("e:\\myoutput.txt", FileMode.OpenOrCreate);
        StreamReader s = new StreamReader(f);
        string line = s.ReadLine();
        Console.WriteLine(line);
        string line2 = s.ReadLine();
        Console.WriteLine(line2);
        s.Close();
        f.Close();

        // 读取所有
        FileStream f = new FileStream("e:\\myoutput.txt", FileMode.OpenOrCreate);
        StreamReader s = new StreamReader(f);
        string line = "";
        while ((line = s.ReadLine()) != null)
        {
            Console.WriteLine(line);
        }
        s.Close();
        f.Close();
```

### 大文本拷贝
```  csharp
private static void CopyFile(string source, string target)
        {
            //创建一个读文件的流
            using (FileStream fsread = new FileStream(source, FileMode.Open))
            {
                //创建一个写文件流
                using (FileStream fswrite = new FileStream(target, FileMode.Create))
                {
                    //创建一个读取文件、写入文件的一个缓冲区
                    //设置缓冲区大小，每次读取内容放到缓冲区中
                    byte[] buffer = new byte[1024 * 1024 * 10];//10MB
                    long len = fsread.Length;
                    //开始读取
                    while (true)
                    {
                        //r 表示本次读到的字节数
                        int r = fsread.Read(buffer, 0, buffer.Length);
 
                        if (r <= 0) //已经到了文件末尾
                        {
                            break;
                        }
                        else      //读到了内容                                                                    
                        {
                            fswrite.Write(buffer, 0, r);
                            long allong = fswrite.Length;   //已经拷贝的长度
                            double proc = (double)allong / len;
                            Console.WriteLine("复制进度：" + proc + "%");
                        }
                    }
                }
            } 
        }
```
https://www.yiibai.com/csharp/c-sharp-stringreader.html